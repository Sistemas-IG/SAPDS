#__AW_Repository_Version '14.2.14.0000';
#__AW_Product_Version '14.2.14.2660';
#__AW_ATL_Locale 'spa_sv.utf-8';
 AlGUIComment ("ActaName_1" = 'RSavedAfterCheckOut', "ActaName_2" = 'RDate_created', "ActaValue_1" = 'YES', "ActaValue_2" = 'Mon Sep 19 16:59:45 2022', "x" = '-1', "y" = '-1')
CREATE DATABASE DATASTORE DS_DB2_GER_VTAS::'0705c125-c4a3-4f1f-9856-d2aa0a018dd5' SET ("DBLiveLoad" = 'no', "application_type" = 'Custom', "cdc_enabled" = 'no', "cdc_type" = 'native', "datastore_repotype" = 'local', "ds_configuration_enabled" = 'yes', "ds_configurations" = '<?xml version="1.0" encoding="WINDOWS-1252" ?>
<DSConfigurations>
<DSConfiguration default="true" name="Configuration1">
<case_sensitive>yes</case_sensitive>
<database_type>ODBC</database_type>
<db_date_format>yyyy-mm-dd</db_date_format>
<db_datetime_format>yyyy-mm-dd hh:mi:ss</db_datetime_format>
<db_decimal_separator>.</db_decimal_separator>
<db_driver_supports_array_fetch>no</db_driver_supports_array_fetch>
<db_driver_supports_param_sql>odbc_automatic</db_driver_supports_param_sql>
<db_time_format>hh:mi:ss</db_time_format>
<loader_xact_size>1000</loader_xact_size>
<locale_codepage>&lt;default&gt;</locale_codepage>
<locale_language>&lt;default&gt;</locale_language>
<locale_territory>&lt;default&gt;</locale_territory>
<odbc_autocommit_support>odbc_automatic</odbc_autocommit_support>
<odbc_convert_func_support>odbc_automatic</odbc_convert_func_support>
<odbc_data_source>Power IBM</odbc_data_source>
<odbc_database_type>OTHER</odbc_database_type>
<odbc_func_absolute>odbc_automatic</odbc_func_absolute>
<odbc_func_avg>odbc_automatic</odbc_func_avg>
<odbc_func_ceiling>odbc_automatic</odbc_func_ceiling>
<odbc_func_count>odbc_automatic</odbc_func_count>
<odbc_func_count_distinct>odbc_automatic</odbc_func_count_distinct>
<odbc_func_dayofmonth>odbc_automatic</odbc_func_dayofmonth>
<odbc_func_dayofyear>odbc_automatic</odbc_func_dayofyear>
<odbc_func_floor>odbc_automatic</odbc_func_floor>
<odbc_func_lcase>odbc_automatic</odbc_func_lcase>
<odbc_func_length>odbc_automatic</odbc_func_length>
<odbc_func_ln>odbc_automatic</odbc_func_ln>
<odbc_func_log>odbc_automatic</odbc_func_log>
<odbc_func_ltrim_blanks>odbc_automatic</odbc_func_ltrim_blanks>
<odbc_func_max>odbc_automatic</odbc_func_max>
<odbc_func_min>odbc_automatic</odbc_func_min>
<odbc_func_mod>odbc_automatic</odbc_func_mod>
<odbc_func_month>odbc_automatic</odbc_func_month>
<odbc_func_power>odbc_automatic</odbc_func_power>
<odbc_func_quarter>odbc_automatic</odbc_func_quarter>
<odbc_func_round>odbc_automatic</odbc_func_round>
<odbc_func_rtrim_blanks>odbc_automatic</odbc_func_rtrim_blanks>
<odbc_func_soundex>odbc_automatic</odbc_func_soundex>
<odbc_func_sqrt>odbc_automatic</odbc_func_sqrt>
<odbc_func_substring>odbc_automatic</odbc_func_substring>
<odbc_func_sum>odbc_automatic</odbc_func_sum>
<odbc_func_sysdate>odbc_automatic</odbc_func_sysdate>
<odbc_func_systime>odbc_automatic</odbc_func_systime>
<odbc_func_truncate>odbc_automatic</odbc_func_truncate>
<odbc_func_ucase>odbc_automatic</odbc_func_ucase>
<odbc_func_week>odbc_automatic</odbc_func_week>
<odbc_func_year>odbc_automatic</odbc_func_year>
<odbc_ifthenelse_func_support>no</odbc_ifthenelse_func_support>
<odbc_ms_access>no</odbc_ms_access>
<odbc_nvarchar_type_name>&lt;unknown&gt;</odbc_nvarchar_type_name>
<odbc_nvl_func_support>odbc_automatic</odbc_nvl_func_support>
<odbc_outer_join_support>odbc_automatic</odbc_outer_join_support>
<odbc_sql92_join_support>odbc_automatic</odbc_sql92_join_support>
<password>+0400000000120303000803E8CB9D536EEE810D365B0049C4C79A4708490FF6A4E237E12B5BB0FBB3BAA91605A494A8166C161278DB7B5BAE36B22E</password>
<server_codepage>&lt;default&gt;</server_codepage>
<server_sorts_in_binary>yes</server_sorts_in_binary>
<user>SIF2016</user>
</DSConfiguration>
</DSConfigurations>
', "enable_data_transfer" = 'yes', "import_unknown_type" = 'yes', "name" = 'DS_DB2_GER_VTAS', "pcache_force_utf16" = 'no', "unknown_type_size" = '255');
 AlGUIComment ("ActaName_1" = 'RSavedAfterCheckOut', "ActaName_2" = 'RDate_created', "ActaName_3" = 'RDate_modified', "ActaValue_1" = 'YES', "ActaValue_2" = 'Wed May 17 15:59:56 2023', "ActaValue_3" = 'Fri Aug 11 11:09:51 2023', "x" = '-1', "y" = '-1')
CREATE DATABASE DATASTORE DS_SQL_SERVER_STAGE_BI_DEV::'20b6c1d2-c9e0-48d9-b67c-c65b1ec918ad' SET ("DBLiveLoad" = 'no', "application_type" = 'Custom', "cdc_enabled" = 'no', "cdc_type" = 'native', "datastore_repotype" = 'local', "ds_configuration_enabled" = 'yes', "ds_configurations" = '<?xml version="1.0" encoding="WINDOWS-1252" ?>
<DSConfigurations>
<DSConfiguration default="true" name="Configuration1">
<case_sensitive>no</case_sensitive>
<cdc_ra_password>+0400000000120303000803E8E02B591689FB1089F25959CA43813806BA438FD233C78CDCA8255F192B4F78A683A3EBA116A3005B813DA2C93F</cdc_ra_password>
<cdc_ra_server>DS_RA</cdc_ra_server>
<cdc_ra_user>sa</cdc_ra_user>
<cdc_rs_password>+0400000000120303000803E828F563E2BD61BA5E4701EC610C2372B3111B78C7B6FE0A7EBB5F5C8028B9BB38EAB047086A06F980052B4A469D</cdc_rs_password>
<cdc_rs_retention>0</cdc_rs_retention>
<cdc_rs_server>SAMPLE_RS</cdc_rs_server>
<cdc_rs_user>ds</cdc_rs_user>
<database_subtype>On Premise</database_subtype>
<database_type>Microsoft_SQL_Server</database_type>
<loader_xact_size>1000</loader_xact_size>
<locale_codepage>&lt;default&gt;</locale_codepage>
<locale_language>&lt;default&gt;</locale_language>
<locale_territory>&lt;default&gt;</locale_territory>
<mssql_windows_authentication>no</mssql_windows_authentication>
<password>+0400000000120303000803E8680CEC7742597FD060919F3A5778064F09644A0327E3A610554A08212E151170278A6A2EC913C9A309C74736F32D348FE9ED0AFE</password>
<server_codepage>&lt;default&gt;</server_codepage>
<sql_server_database>STAGE_BI</sql_server_database>
<sql_server_dataserver>perseo.superrepuestos.domain</sql_server_dataserver>
<sql_server_version>Microsoft SQL Server 2019</sql_server_version>
<use_ssl_encryption>no</use_ssl_encryption>
<user>sa</user>
</DSConfiguration>
</DSConfigurations>
', "enable_data_transfer" = 'yes', "import_unknown_type" = 'no', "name" = 'DS_SQL_SERVER_STAGE_BI_DEV', "pcache_force_utf16" = 'no', "unknown_type_size" = '255');

 AlGUIComment (ActaName_1 = 'RDate_last_loaded',ActaValue_1 = 'Wed Jan 22 10:59:47 2025' , 
ActaName_2 = 'RTotal_Number_Of_Rows_Processed',ActaValue_2 = '183149' , 
ActaName_3 = 'RNumber_Of_Rows_Rejected',ActaValue_3 = '0' , 
ActaName_4 = 'RDatabase_Object_Type',ActaValue_4 = 'TABLE' , 
ActaName_5 = 'RTable_Type',ActaValue_5 = 'TABLE' , 
ActaName_6 = 'RDescription',ActaValue_6 = '' , 
ActaName_7 = 'REstimated_Row_Count',ActaValue_7 = '50000' , 
ActaName_8 = 'RSavedAfterCheckOut',ActaValue_8 = 'YES' , 
ActaName_9 = 'RLoader_Is_Template_Table',ActaValue_9 = 'no' , 
ActaName_10 = 'RNumber_Of_Inserts',ActaValue_10 = '183149' , 
ActaName_11 = 'RDate_modified',ActaValue_11 = 'Wed Jan 22 10:57:52 2025' , 
ActaName_12 = 'RNumber_Of_Updates',ActaValue_12 = '0' , 
ActaName_13 = 'RNumber_Of_Deletes',ActaValue_13 = '0' , 
ActaName_14 = 'RElapsed_Time_For_Load',ActaValue_14 = '7 Seconds' )
CREATE TABLE DS_SQL_SERVER_STAGE_BI_DEV.DWH.CA(TIPOCA VARCHAR(1)  NULL , 
CODICA VARCHAR(4)  NULL , 
COMPCA VARCHAR(9)  NULL , 
VALOCA DECIMAL(9, 2)  NULL , 
COACA VARCHAR(1)  NULL , 
FECHCA VARCHAR(8)  NULL , 
ALMACA VARCHAR(2)  NULL , 
Periodo VARCHAR(6)  NULL , 
ID_PAIS INT  NULL , 
FECHA_CREACION_DWH DATETIME(7)  NULL  SET("Native Type" = 'DATETIME2')) 
SET("db_alias_name" = 'DWH')
;
 AlGUIComment ("ActaName_1" = 'RSavedAfterCheckOut', "ActaName_2" = 'RDate_created', "ActaName_3" = 'RDate_modified', "ActaValue_1" = 'YES', "ActaValue_2" = 'Tue Jan 21 18:37:08 2025', "ActaValue_3" = 'Wed Jan 22 09:21:47 2025', "x" = '-1', "y" = '-1')
CREATE  DATAFLOW DF_CA_NW_PW::'b141b085-ff57-4ce6-a646-4df06ae29de4'
BEGIN

ALGUIComment ("InputSchema_WidthProp" = '42', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Description', "Output_3rd_Column_Name" = 'Content_Type', "Output_Column_Name_4" = 'Business_Name', "Output_Column_Name_5" = 'Description', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>194</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UpperContainer_HeightProp" = '62', "ui_display_name" = 'CA_SV', "x" = '803', "y" = '-628')
GUID::'df912e77-daa6-4627-aafe-1d0bdaddbab6' CALL TRANSFORM SQL() OUTPUT(CA_SV( TIPOCA VARCHAR(1) ,
 CODICA VARCHAR(4) ,
 COMPCA VARCHAR(9) ,
 VALOCA DECIMAL(9, 2) ,
 COACA VARCHAR(1) ,
 FECHCA VARCHAR(8) ,
 ALMACA VARCHAR(2) ,
 PERIODO VARCHAR(4) ,
 ID_PAIS INT  )
)
SET("array_fetch_size" = '1000', "cache" = 'no', "database_datastore" = 'DS_DB2_GER_VTAS', "sql_transform_configuration_enabled" = 'yes', "sql_transform_configurations" = '<?xml version="1.0" encoding="UTF-8"?>
<SQLTexts>
<SQLText database_type="ODBC" database_version="ODBC">
<odbc_database_type>OTHER</odbc_database_type>
<sql_text>select TIPOCA, CODICA, COMPCA,VALOCA,COACA, FECHCA,ALMACA, [$Desde] Periodo, 1 ID_PAIS   from [$tbl_NEWINV][$Desde]</sql_text>
</SQLText>
</SQLTexts>', "table_weight" = '0');

ALGUIComment ("InputSchema_WidthProp" = '46', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Mapping', "Output_3rd_Column_Name" = 'Description', "Output_Column_Name_4" = 'Content_Type', "Output_Column_Name_5" = 'Business_Name', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>238</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UI_PASSTHRU_VSPLIT_PCT" = '50', "UpperContainer_HeightProp" = '45', "ui_acta_from_schema_0" = 'Merge', "x" = '2243', "y" = '-756')
GUID::'81708cf5-8c13-480c-99a1-a2b00785cba2' CREATE VIEW Query( TIPOCA VARCHAR(1)  SET( "ui_mapping_text" = 'Merge.TIPOCA') ,
 CODICA VARCHAR(4)  SET( "ui_mapping_text" = 'Merge.CODICA') ,
 COMPCA VARCHAR(9)  SET( "ui_mapping_text" = 'Merge.COMPCA') ,
 VALOCA DECIMAL(9, 2)  SET( "ui_mapping_text" = 'Merge.VALOCA') ,
 COACA VARCHAR(1)  SET( "ui_mapping_text" = 'Merge.COACA') ,
 FECHCA VARCHAR(8)  SET( "ui_mapping_text" = 'Merge.FECHCA') ,
 ALMACA VARCHAR(2)  SET( "ui_mapping_text" = 'Merge.ALMACA') ,
 PERIODO VARCHAR(4)  SET( "ui_mapping_text" = 'Merge.PERIODO') ,
 ID_PAIS INT  SET( "ui_mapping_text" = 'Merge.ID_PAIS') ,
 FECHA_CREACION_DWH DATETIME(9)  SET( "ui_mapping_text" = 'sysdate()')  )
 AS
SELECT Merge.TIPOCA, Merge.CODICA, Merge.COMPCA, Merge.VALOCA, Merge.COACA, Merge.FECHCA, Merge.ALMACA, Merge.PERIODO, Merge.ID_PAIS, sysdate() FROM Merge 
SET("distinct_run_as_separate_process" = 'no', "group_by_run_as_separate_process" = 'no', "join_run_as_separate_process" = 'no', "order_by_run_as_separate_process" = 'no', "run_as_separate_process" = 'no')
;

ALGUIComment ("InputSchema_WidthProp" = '46', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Description', "Output_3rd_Column_Name" = 'Content_Type', "Output_Column_Name_4" = 'Business_Name', "Output_Column_Name_5" = 'Description', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>238</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UpperContainer_HeightProp" = '45', "x" = '1766', "y" = '-758')
GUID::'32af7459-146d-4155-80bf-a2b8321fe769' CALL TRANSFORM Merge() INPUT(Query_HN, Query_SV) OUTPUT(Merge()
);

ALGUIComment ("InputSchema_WidthProp" = '46', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Mapping', "Output_3rd_Column_Name" = 'Description', "Output_Column_Name_4" = 'Content_Type', "Output_Column_Name_5" = 'Business_Name', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>238</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UI_PASSTHRU_VSPLIT_PCT" = '50', "UpperContainer_HeightProp" = '45', "ui_acta_from_schema_0" = 'CA_HN', "ui_display_name" = 'Query_HN', "x" = '1302', "y" = '-974')
GUID::'97ce39cc-7479-42e0-9231-457a700dce8c' CREATE VIEW Query_HN( TIPOCA VARCHAR(1)  SET( "ui_mapping_text" = 'CA_HN.TIPOCA') ,
 CODICA VARCHAR(4)  SET( "ui_mapping_text" = 'CA_HN.CODICA') ,
 COMPCA VARCHAR(9)  SET( "ui_mapping_text" = 'CA_HN.COMPCA') ,
 VALOCA DECIMAL(9, 2)  SET( "ui_mapping_text" = 'CA_HN.VALOCA') ,
 COACA VARCHAR(1)  SET( "ui_mapping_text" = 'CA_HN.COACA') ,
 FECHCA VARCHAR(8)  SET( "ui_mapping_text" = 'CA_HN.FECHCA') ,
 ALMACA VARCHAR(2)  SET( "ui_mapping_text" = 'CA_HN.ALMACA') ,
 PERIODO VARCHAR(4)  SET( "ui_mapping_text" = 'CA_HN.PERIODO') ,
 ID_PAIS INT  SET( "ui_mapping_text" = 'CA_HN.ID_PAIS')  )
 AS
SELECT CA_HN.TIPOCA, CA_HN.CODICA, CA_HN.COMPCA, CA_HN.VALOCA, CA_HN.COACA, CA_HN.FECHCA, CA_HN.ALMACA, CA_HN.PERIODO, CA_HN.ID_PAIS FROM CA_HN 
SET("distinct_run_as_separate_process" = 'no', "group_by_run_as_separate_process" = 'no', "join_run_as_separate_process" = 'no', "order_by_run_as_separate_process" = 'no', "run_as_separate_process" = 'no')
;

ALGUIComment ("InputSchema_WidthProp" = '46', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Mapping', "Output_3rd_Column_Name" = 'Description', "Output_Column_Name_4" = 'Content_Type', "Output_Column_Name_5" = 'Business_Name', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>238</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UI_PASSTHRU_VSPLIT_PCT" = '50', "UpperContainer_HeightProp" = '45', "ui_acta_from_schema_0" = 'CA_SV', "ui_display_name" = 'Query_SV', "x" = '1284', "y" = '-610')
GUID::'9295c51a-c5fc-4e31-bd5b-5b65fef675f2' CREATE VIEW Query_SV( TIPOCA VARCHAR(1)  SET( "ui_mapping_text" = 'CA_SV.TIPOCA') ,
 CODICA VARCHAR(4)  SET( "ui_mapping_text" = 'CA_SV.CODICA') ,
 COMPCA VARCHAR(9)  SET( "ui_mapping_text" = 'CA_SV.COMPCA') ,
 VALOCA DECIMAL(9, 2)  SET( "ui_mapping_text" = 'CA_SV.VALOCA') ,
 COACA VARCHAR(1)  SET( "ui_mapping_text" = 'CA_SV.COACA') ,
 FECHCA VARCHAR(8)  SET( "ui_mapping_text" = 'CA_SV.FECHCA') ,
 ALMACA VARCHAR(2)  SET( "ui_mapping_text" = 'CA_SV.ALMACA') ,
 PERIODO VARCHAR(4)  SET( "ui_mapping_text" = 'CA_SV.PERIODO') ,
 ID_PAIS INT  SET( "ui_mapping_text" = 'CA_SV.ID_PAIS')  )
 AS
SELECT CA_SV.TIPOCA, CA_SV.CODICA, CA_SV.COMPCA, CA_SV.VALOCA, CA_SV.COACA, CA_SV.FECHCA, CA_SV.ALMACA, CA_SV.PERIODO, CA_SV.ID_PAIS FROM CA_SV 
SET("distinct_run_as_separate_process" = 'no', "group_by_run_as_separate_process" = 'no', "join_run_as_separate_process" = 'no', "order_by_run_as_separate_process" = 'no', "run_as_separate_process" = 'no')
;

ALGUIComment ("InputSchema_WidthProp" = '42', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Description', "Output_3rd_Column_Name" = 'Content_Type', "Output_Column_Name_4" = 'Business_Name', "Output_Column_Name_5" = 'Description', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>194</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UpperContainer_HeightProp" = '62', "ui_display_name" = 'CA_HN', "x" = '820', "y" = '-978')
GUID::'166651dc-7a16-4032-988e-7f42bf775bd9' CALL TRANSFORM SQL() OUTPUT(CA_HN( TIPOCA VARCHAR(1) ,
 CODICA VARCHAR(4) ,
 COMPCA VARCHAR(9) ,
 VALOCA DECIMAL(9, 2) ,
 COACA VARCHAR(1) ,
 FECHCA VARCHAR(8) ,
 ALMACA VARCHAR(2) ,
 PERIODO VARCHAR(4) ,
 ID_PAIS INT  )
)
SET("array_fetch_size" = '1000', "cache" = 'no', "database_datastore" = 'DS_DB2_GER_VTAS', "sql_transform_configuration_enabled" = 'yes', "sql_transform_configurations" = '<?xml version="1.0" encoding="UTF-8"?>
<SQLTexts>
<SQLText database_type="ODBC" database_version="ODBC">
<odbc_database_type>OTHER</odbc_database_type>
<sql_text>select TIPOCA, CODICA, COMPCA,VALOCA,COACA, FECHCA,ALMACA,[$Desde] Periodo, 2 ID_PAIS  from [$tbl_PHNINV][$Desde]</sql_text>
</SQLText>
</SQLTexts>', "table_weight" = '0');

ALGUIComment ("InputSchema_WidthProp" = '42', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Description', "Output_3rd_Column_Name" = 'Content_Type', "Output_Column_Name_4" = 'Business_Name', "Output_Column_Name_5" = 'Description', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>435</CX><CY>-183</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UI_PASSTHRU_VSPLIT_PCT" = '50', "UpperContainer_HeightProp" = '62', "x" = '2700', "y" = '-756')
GUID::'5caf7c96-25c9-4338-acb8-39886863b043' LOAD TABLE DS_SQL_SERVER_STAGE_BI_DEV.DWH.CA INPUT(Query)
SET("LDRLiveLoad" = 'no', "Table_Type" = 'TABLE', "connection_port" = 'no', "ldr_configuration_enabled" = 'yes', "ldr_configurations" = '<?xml version="1.0" encoding="UTF-8"?>
<LDRConfigurations>
<LDRConfiguration database_type="Microsoft_SQL_Server" database_version="Microsoft SQL Server 2019">
<auto_correct_using_merge>yes</auto_correct_using_merge>
<bulk_col_delimiter>/127</bulk_col_delimiter>
<bulk_ldr_all_rows></bulk_ldr_all_rows>
<bulk_ldr_cleanup>yes</bulk_ldr_cleanup>
<bulk_ldr_max_errors></bulk_ldr_max_errors>
<bulk_ldr_rows_per_commit>3000</bulk_ldr_rows_per_commit>
<enable_partitioning>no</enable_partitioning>
<ignore_column_case>yes</ignore_column_case>
<ignore_columns_null>no</ignore_columns_null>
<ignore_columns_value></ignore_columns_value>
<loader_auto_correct>no</loader_auto_correct>
<loader_bulk_load>1</loader_bulk_load>
<loader_compare_column>compare_by_name</loader_compare_column>
<loader_delete_map></loader_delete_map>
<loader_drop_and_create_table>no</loader_drop_and_create_table>
<loader_fl_object_name></loader_fl_object_name>
<loader_insert_map></loader_insert_map>
<loader_load_choice>append</loader_load_choice>
<loader_num_parallel_loaders>1</loader_num_parallel_loaders>
<loader_overflow_file>DS_SQL_SERVER_STAGE_BI_DEV_DWH_CA.txt</loader_overflow_file>
<loader_post_load1></loader_post_load1>
<loader_pre_load1></loader_pre_load1>
<loader_quote_names>0</loader_quote_names>
<loader_transactional>no</loader_transactional>
<loader_transactional_order>0</loader_transactional_order>
<loader_update_key_columns>no</loader_update_key_columns>
<loader_update_map></loader_update_map>
<loader_use_user_defined_keys>no</loader_use_user_defined_keys>
<loader_xact_size>1000</loader_xact_size>
<mssql_bulk_ldr_mode>append</mssql_bulk_ldr_mode>
<mssql_bulk_ldr_packet_size>4</mssql_bulk_ldr_packet_size>
<mssql_ldr_identity_insert>off</mssql_ldr_identity_insert>
<overflow_file_format>write_data</overflow_file_format>
<overriding_substitution_parameter_for_tablename></overriding_substitution_parameter_for_tablename>
<sql_text></sql_text>
<text_delimiter></text_delimiter>
<use_overflow_file>no</use_overflow_file>
<use_unicode_varchar>no</use_unicode_varchar>
<sql_text></sql_text>
</LDRConfiguration>
</LDRConfigurations>', "loader_template_table" = 'no', "name" = 'DS_SQL_SERVER_STAGE_BI_DEV', "use_unicode_varchar" = 'no');

END
 SET ("Cache_type" = 'pageable_cache', "Parallelism_degree" = 'default', "allows_both_input_and_output" = 'yes', "dataflow_loader_bulk_load" = 'no', "dataflow_loader_commit_size" = 'default', "dataflow_loader_row_size_bytes" = '0', "dataflow_number_of_loaders" = '0', "run_once" = 'no', "use_dataflow_links" = 'no', "use_datastore_links" = 'yes', "validation_xform_exists" = 'no', "validation_xform_stats" = 'no')
 AlGUIComment ("ActaName_1" = 'RSavedAfterCheckOut', "ActaName_2" = 'RDate_created', "ActaName_3" = 'RDate_modified', "ActaValue_1" = 'YES', "ActaValue_2" = 'Wed Sep  4 16:09:04 2024', "ActaValue_3" = 'Wed Jan 22 10:59:28 2025', "x" = '-1', "y" = '-1')
CREATE  DATAFLOW DF_CRG_STG_CA::'785e3100-169f-4085-9394-df7a4b653289'
BEGIN

ALGUIComment ("InputSchema_WidthProp" = '46', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Mapping', "Output_3rd_Column_Name" = 'Description', "Output_Column_Name_4" = 'Content_Type', "Output_Column_Name_5" = 'Business_Name', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>238</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UI_PASSTHRU_VSPLIT_PCT" = '50', "UpperContainer_HeightProp" = '45', "ui_acta_from_schema_0" = 'CA25', "ui_display_name" = 'Query_SV', "x" = '731', "y" = '-414')
GUID::'a0d2003a-4aaa-427f-be03-f2381afa3ad7' CREATE VIEW Query_SV( TIPOCA VARCHAR(1)  SET( "Description" = 'Cuenta tipo', "ui_mapping_text" = 'CA25.TIPOCA') ,
 CODICA VARCHAR(4)  SET( "Description" = 'Cliente', "ui_mapping_text" = 'CA25.CODICA') ,
 COMPCA VARCHAR(9)  SET( "Description" = 'Comprobante', "ui_mapping_text" = 'CA25.COMPCA') ,
 VALOCA DECIMAL(9, 2)  SET( "Description" = 'Valor', "ui_mapping_text" = 'CA25.VALOCA') ,
 COACA VARCHAR(1)  SET( "Description" = 'Cargo o Abono', "ui_mapping_text" = 'CA25.COACA') ,
 FECHCA VARCHAR(8)  SET( "Description" = 'Fecha', "ui_mapping_text" = 'CA25.FECHCA') ,
 ALMACA VARCHAR(2)  SET( "Description" = 'Almacen', "ui_mapping_text" = 'CA25.ALMACA') ,
 PERIODO VARCHAR(4)  SET( "ui_mapping_text" = 'CA25.PERIODO') ,
 ID_PAIS INT  SET( "ui_mapping_text" = 'CA25.ID_PAIS') ,
 Fecha_creacion_DWH DATETIME(9)  SET( "ui_mapping_text" = 'sysdate()')  )
 AS
SELECT CA25.TIPOCA, CA25.CODICA, CA25.COMPCA, CA25.VALOCA, CA25.COACA, CA25.FECHCA, CA25.ALMACA, CA25.PERIODO, CA25.ID_PAIS, sysdate() FROM CA25 
SET("distinct_run_as_separate_process" = 'no', "group_by_run_as_separate_process" = 'no', "join_run_as_separate_process" = 'no', "order_by_run_as_separate_process" = 'no', "run_as_separate_process" = 'no')
;

ALGUIComment ("InputSchema_WidthProp" = '46', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Mapping', "Output_3rd_Column_Name" = 'Description', "Output_Column_Name_4" = 'Content_Type', "Output_Column_Name_5" = 'Business_Name', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>238</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UI_PASSTHRU_VSPLIT_PCT" = '50', "UpperContainer_HeightProp" = '45', "ui_acta_from_schema_0" = 'CA25_1', "ui_display_name" = 'Query_HN', "x" = '749', "y" = '-778')
GUID::'f013947c-0d23-4170-8933-47b368c3524b' CREATE VIEW Query_HN( TIPOCA VARCHAR(1)  SET( "Description" = 'Cuenta tipo', "ui_mapping_text" = 'CA25_1.TIPOCA') ,
 CODICA VARCHAR(4)  SET( "Description" = 'Cliente', "ui_mapping_text" = 'CA25_1.CODICA') ,
 COMPCA VARCHAR(9)  SET( "Description" = 'Comprobante', "ui_mapping_text" = 'CA25_1.COMPCA') ,
 VALOCA DECIMAL(9, 2)  SET( "Description" = 'Valor', "ui_mapping_text" = 'CA25_1.VALOCA') ,
 COACA VARCHAR(1)  SET( "Description" = 'Cargo o Abono', "ui_mapping_text" = 'CA25_1.COACA') ,
 FECHCA VARCHAR(8)  SET( "Description" = 'Fecha', "ui_mapping_text" = 'CA25_1.FECHCA') ,
 ALMACA VARCHAR(2)  SET( "Description" = 'Almacen', "ui_mapping_text" = 'CA25_1.ALMACA') ,
 PERIODO VARCHAR(4)  SET( "ui_mapping_text" = 'CA25_1.PERIODO') ,
 ID_PAIS INT  SET( "ui_mapping_text" = 'CA25_1.ID_PAIS') ,
 Fecha_creacion_DWH DATETIME(9)  SET( "ui_mapping_text" = 'sysdate()')  )
 AS
SELECT CA25_1.TIPOCA, CA25_1.CODICA, CA25_1.COMPCA, CA25_1.VALOCA, CA25_1.COACA, CA25_1.FECHCA, CA25_1.ALMACA, CA25_1.PERIODO, CA25_1.ID_PAIS, sysdate() FROM CA25_1 
SET("distinct_run_as_separate_process" = 'no', "group_by_run_as_separate_process" = 'no', "join_run_as_separate_process" = 'no', "order_by_run_as_separate_process" = 'no', "run_as_separate_process" = 'no')
;

ALGUIComment ("InputSchema_WidthProp" = '46', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Description', "Output_3rd_Column_Name" = 'Content_Type', "Output_Column_Name_4" = 'Business_Name', "Output_Column_Name_5" = 'Description', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>238</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UpperContainer_HeightProp" = '45', "x" = '1213', "y" = '-562')
GUID::'d980c8a9-0f91-4fd0-a08b-e8d9a811f992' CALL TRANSFORM Merge() INPUT(Query_HN, Query_SV) OUTPUT(Merge()
);

ALGUIComment ("InputSchema_WidthProp" = '46', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Mapping', "Output_3rd_Column_Name" = 'Description', "Output_Column_Name_4" = 'Content_Type', "Output_Column_Name_5" = 'Business_Name', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>238</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UI_PASSTHRU_VSPLIT_PCT" = '50', "UpperContainer_HeightProp" = '45', "ui_acta_from_schema_0" = 'Merge', "x" = '1690', "y" = '-560')
GUID::'f6bcd83a-534f-4084-9cab-dcc5d4315732' CREATE VIEW Query( TIPOCA VARCHAR(1)  SET( "Description" = 'Cuenta tipo', "ui_mapping_text" = 'Merge.TIPOCA') ,
 CODICA VARCHAR(4)  SET( "Description" = 'Cliente', "ui_mapping_text" = 'Merge.CODICA') ,
 COMPCA VARCHAR(9)  SET( "Description" = 'Comprobante', "ui_mapping_text" = 'Merge.COMPCA') ,
 VALOCA DECIMAL(9, 2)  SET( "Description" = 'Valor', "ui_mapping_text" = 'Merge.VALOCA') ,
 COACA VARCHAR(1)  SET( "Description" = 'Cargo o Abono', "ui_mapping_text" = 'Merge.COACA') ,
 FECHCA VARCHAR(8)  SET( "Description" = 'Fecha', "ui_mapping_text" = 'Merge.FECHCA') ,
 ALMACA VARCHAR(2)  SET( "Description" = 'Almacen', "ui_mapping_text" = 'Merge.ALMACA') ,
 PERIODO VARCHAR(4)  SET( "ui_mapping_text" = 'Merge.PERIODO') ,
 ID_PAIS INT  SET( "ui_mapping_text" = 'Merge.ID_PAIS') ,
 Fecha_creacion_DWH DATETIME(9)  SET( "ui_mapping_text" = 'Merge.Fecha_creacion_DWH')  )
 AS
SELECT Merge.TIPOCA, Merge.CODICA, Merge.COMPCA, Merge.VALOCA, Merge.COACA, Merge.FECHCA, Merge.ALMACA, Merge.PERIODO, Merge.ID_PAIS, Merge.Fecha_creacion_DWH FROM Merge 
SET("distinct_run_as_separate_process" = 'no', "group_by_run_as_separate_process" = 'no', "join_run_as_separate_process" = 'no', "order_by_run_as_separate_process" = 'no', "run_as_separate_process" = 'no')
;

ALGUIComment ("InputSchema_WidthProp" = '42', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Description', "Output_3rd_Column_Name" = 'Content_Type', "Output_Column_Name_4" = 'Business_Name', "Output_Column_Name_5" = 'Description', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>194</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UpperContainer_HeightProp" = '62', "ui_display_name" = 'CA25', "x" = '250', "y" = '-432')
GUID::'c9cc4096-28c7-4e2b-bdf8-c429c6685293' CALL TRANSFORM SQL() OUTPUT(CA25( TIPOCA VARCHAR(1) ,
 CODICA VARCHAR(4) ,
 COMPCA VARCHAR(9) ,
 VALOCA DECIMAL(9, 2) ,
 COACA VARCHAR(1) ,
 FECHCA VARCHAR(8) ,
 ALMACA VARCHAR(2) ,
 PERIODO VARCHAR(4) ,
 ID_PAIS INT  )
)
SET("array_fetch_size" = '1000', "cache" = 'no', "database_datastore" = 'DS_DB2_GER_VTAS', "sql_transform_configuration_enabled" = 'yes', "sql_transform_configurations" = '<?xml version="1.0" encoding="UTF-8"?>
<SQLTexts>
<SQLText database_type="ODBC" database_version="ODBC">
<odbc_database_type>OTHER</odbc_database_type>
<sql_text>select TIPOCA, CODICA, COMPCA,VALOCA,COACA, FECHCA,ALMACA, [$periodo] Periodo ,1 ID_PAIS  from [$NEWINVCA]</sql_text>
</SQLText>
</SQLTexts>', "table_weight" = '0');

ALGUIComment ("InputSchema_WidthProp" = '42', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Description', "Output_3rd_Column_Name" = 'Content_Type', "Output_Column_Name_4" = 'Business_Name', "Output_Column_Name_5" = 'Description', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>194</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UpperContainer_HeightProp" = '62', "ui_display_name" = 'CA25', "x" = '271', "y" = '-822')
GUID::'932017b7-d72d-463e-a357-06772c37adaa' CALL TRANSFORM SQL() OUTPUT(CA25_1( TIPOCA VARCHAR(1) ,
 CODICA VARCHAR(4) ,
 COMPCA VARCHAR(9) ,
 VALOCA DECIMAL(9, 2) ,
 COACA VARCHAR(1) ,
 FECHCA VARCHAR(8) ,
 ALMACA VARCHAR(2) ,
 PERIODO VARCHAR(4) ,
 ID_PAIS INT  )
)
SET("array_fetch_size" = '1000', "cache" = 'no', "database_datastore" = 'DS_DB2_GER_VTAS', "sql_transform_configuration_enabled" = 'yes', "sql_transform_configurations" = '<?xml version="1.0" encoding="UTF-8"?>
<SQLTexts>
<SQLText database_type="ODBC" database_version="ODBC">
<odbc_database_type>OTHER</odbc_database_type>
<sql_text>select TIPOCA, CODICA, COMPCA,VALOCA,COACA, FECHCA,ALMACA, [$periodo] Periodo,1 ID_PAIS  from [$PHNINVCA]</sql_text>
</SQLText>
</SQLTexts>', "table_weight" = '0');

ALGUIComment ("InputSchema_WidthProp" = '42', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Description', "Output_3rd_Column_Name" = 'Content_Type', "Output_Column_Name_4" = 'Business_Name', "Output_Column_Name_5" = 'Description', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>435</CX><CY>-183</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UI_PASSTHRU_VSPLIT_PCT" = '50', "UpperContainer_HeightProp" = '62', "x" = '2259', "y" = '-566')
GUID::'8c09455c-c36f-4d9b-8d70-1b9d746e3bb0' LOAD TABLE DS_SQL_SERVER_STAGE_BI_DEV.DWH.CA INPUT(Query)
SET("LDRLiveLoad" = 'no', "Table_Type" = 'TABLE', "connection_port" = 'no', "ldr_configuration_enabled" = 'yes', "ldr_configurations" = '<?xml version="1.0" encoding="UTF-8"?>
<LDRConfigurations>
<LDRConfiguration database_type="Microsoft_SQL_Server" database_version="Microsoft SQL Server 2019">
<auto_correct_using_merge>yes</auto_correct_using_merge>
<bulk_col_delimiter>/127</bulk_col_delimiter>
<bulk_ldr_all_rows></bulk_ldr_all_rows>
<bulk_ldr_cleanup>yes</bulk_ldr_cleanup>
<bulk_ldr_max_errors></bulk_ldr_max_errors>
<bulk_ldr_rows_per_commit>1000</bulk_ldr_rows_per_commit>
<enable_partitioning>no</enable_partitioning>
<ignore_column_case>yes</ignore_column_case>
<ignore_columns_null>no</ignore_columns_null>
<ignore_columns_value></ignore_columns_value>
<loader_auto_correct>no</loader_auto_correct>
<loader_bulk_load></loader_bulk_load>
<loader_compare_column>compare_by_name</loader_compare_column>
<loader_delete_map></loader_delete_map>
<loader_drop_and_create_table>no</loader_drop_and_create_table>
<loader_fl_object_name></loader_fl_object_name>
<loader_insert_map></loader_insert_map>
<loader_load_choice>append</loader_load_choice>
<loader_num_parallel_loaders>1</loader_num_parallel_loaders>
<loader_overflow_file>DS_SQL_SERVER_STAGE_BI_DEV_DWH_CA.txt</loader_overflow_file>
<loader_post_load1></loader_post_load1>
<loader_pre_load1></loader_pre_load1>
<loader_quote_names>0</loader_quote_names>
<loader_transactional>no</loader_transactional>
<loader_transactional_order>0</loader_transactional_order>
<loader_update_key_columns>no</loader_update_key_columns>
<loader_update_map></loader_update_map>
<loader_use_user_defined_keys>no</loader_use_user_defined_keys>
<loader_xact_size>1000</loader_xact_size>
<mssql_bulk_ldr_mode>append</mssql_bulk_ldr_mode>
<mssql_bulk_ldr_packet_size>4</mssql_bulk_ldr_packet_size>
<mssql_ldr_identity_insert>off</mssql_ldr_identity_insert>
<overflow_file_format>write_data</overflow_file_format>
<overriding_substitution_parameter_for_tablename></overriding_substitution_parameter_for_tablename>
<sql_text></sql_text>
<text_delimiter></text_delimiter>
<use_overflow_file>no</use_overflow_file>
<use_unicode_varchar>no</use_unicode_varchar>
<sql_text></sql_text>
</LDRConfiguration>
</LDRConfigurations>', "loader_template_table" = 'no', "name" = 'DS_SQL_SERVER_STAGE_BI_DEV', "use_unicode_varchar" = 'no');

END
 SET ("Cache_type" = 'pageable_cache', "Parallelism_degree" = 'default', "allows_both_input_and_output" = 'yes', "dataflow_loader_bulk_load" = 'no', "dataflow_loader_commit_size" = 'default', "dataflow_loader_row_size_bytes" = '0', "dataflow_number_of_loaders" = '0', "run_once" = 'no', "use_dataflow_links" = 'no', "use_datastore_links" = 'yes', "validation_xform_exists" = 'no', "validation_xform_stats" = 'no')
 AlGUIComment ("x" = '-1', "y" = '-1')
CREATE PLAN WF_CA::'003c633f-5416-4662-b4e4-7ed57adb4b11'( )
BEGIN
 AlGUIComment ("UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>216</CX><CY>-179</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-190</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "ui_display_name" = 'SC_INICIO', "ui_script_text" = '$conteo = -25;
$tbl_NEWINV = \'NEWINV.CA\';
$tbl_PHNINV = \'PHNINV.CA\';
$Desde = to_char(add_months(sysdate(),$conteo),\'YYMM\');
$Hasta = to_char(sysdate(),\'YYMM\');
print(\'Desde \'||$Desde ||\' Hasta \'||$Hasta);

', "x" = '0', "y" = '-7')
BEGIN_SCRIPT
$conteo = -25;$tbl_NEWINV = 'NEWINV.CA';$tbl_PHNINV = 'PHNINV.CA';$Desde = to_char(add_months(sysdate(), $conteo), 'YYMM');$Hasta = to_char(sysdate(), 'YYMM');print(((('Desde ' || $Desde) || ' Hasta ') || $Hasta));END
 AlGUIComment ("UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>228</CX><CY>-179</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-190</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "ui_display_name" = 'While56374', "x" = '435', "y" = '-3')
WHILE (($Desde < $Hasta) )
BEGIN
 AlGUIComment ("UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>241</CX><CY>-179</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-190</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "ui_display_name" = 'SC_Proceso', "ui_script_text" = '$conteo = $conteo + 1;

print($conteo);

$Desde = to_char(add_months(sysdate(),$conteo),\'YYMM\');
print($tbl_NEWINV||$Desde);
print($tbl_PHNINV||$Desde);

#select TIPOCA, CODICA, COMPCA,VALOCA,COACA, FECHCA,ALMACA, [$Desde] Periodo, 1 ID_PAIS   from [$tbl_NEWINV]

', "x" = '453', "y" = '-606')
BEGIN_SCRIPT
$conteo = ($conteo + 1);print($conteo);$Desde = to_char(add_months(sysdate(), $conteo), 'YYMM');print(($tbl_NEWINV || $Desde));print(($tbl_PHNINV || $Desde));END
 AlGUIComment ("UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>300</CX><CY>-179</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-190</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "x" = '1177', "y" = '-606')
CALL DATAFLOW DF_CA_NW_PW::'b141b085-ff57-4ce6-a646-4df06ae29de4'();
END
 AlGUIComment ("UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>222</CX><CY>-179</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-190</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "ui_display_name" = 'SC_INICIO1', "ui_script_text" = '$tbl_NEWINV = \'NEWINV.CA\';
$tbl_PHNINV = \'PHNINV.CA\';
$fecha_ini = \'00000000\';
$periodo = to_char(sysdate(),\'YYMM\');
#---------------------------------------------------------------------------------------------
print($tbl_PHNINV);
$Fecha_minima_HN  =\'\';
$Fecha_maxima_HN   =\'\';

$PHNINVCA = $tbl_PHNINV||$periodo;
print($PHNINVCA);
 
$Fecha_minima_HN  = sql(\'DS_DB2_GER_VTAS\', \'select Min(Fechca) from \'||$PHNINVCA||\' Where fechca != \'||$fecha_ini||\'\');
$Fecha_maxima_HN  = sql(\'DS_DB2_GER_VTAS\', \'select Max(Fechca) from \'||$PHNINVCA||\' Where fechca != \'||$fecha_ini||\'\');

print(\'HN: Fecha Minima: \'|| $Fecha_minima_HN||\' Fecha Maxima: \'|| $Fecha_maxima_HN );

#print(\'Delete from stage_bi.dwh.ca Where id_pais=2 and fechaca between \'|| $Fecha_minima ||\' and \'|| $Fecha_maxima  );


sql(\'DS_SQL_SERVER_STAGE_BI_DEV\', \'DELETE FROM STAGE_BI.DWH.CA WHERE id_pais = 2 and FECHCA between \'|| $Fecha_minima_HN  || \' and \' || $Fecha_maxima_HN  || \';\');

#----------------------------------------------------------------------------------------------------

$NEWINVCA = $tbl_NEWINV||$periodo;
print($tbl_NEWINV||$periodo);

print($NEWINVCA);

$Fecha_minima_SV  =\'\';
$Fecha_maxima_SV   =\'\';
$Fecha_minima_SV  = sql(\'DS_DB2_GER_VTAS\', \'select Min(Fechca) from \'||$NEWINVCA||\' Where fechca != \\\'\'||$fecha_ini||\'\\\'\');
$Fecha_maxima_SV  = sql(\'DS_DB2_GER_VTAS\', \'select Max(Fechca) from \'||$NEWINVCA||\' Where fechca != \\\'\'||$fecha_ini||\'\\\'\');

print(\'SV: Fecha Minima: \'|| $Fecha_minima_SV ||\' Fecha Maxima: \'||$Fecha_maxima_SV );

sql(\'DS_SQL_SERVER_STAGE_BI_DEV\', \'DELETE FROM STAGE_BI.DWH.CA WHERE id_pais = 1 and FECHCA between \'|| $Fecha_minima_SV  || \' and \' || $Fecha_maxima_SV  || \';\');', "x" = '938', "y" = '-4')
BEGIN_SCRIPT
$tbl_NEWINV = 'NEWINV.CA';$tbl_PHNINV = 'PHNINV.CA';$fecha_ini = '00000000';$periodo = to_char(sysdate(), 'YYMM');print($tbl_PHNINV);$Fecha_minima_HN = '';$Fecha_maxima_HN = '';$PHNINVCA = ($tbl_PHNINV || $periodo);print($PHNINVCA);$Fecha_minima_HN = sql('DS_DB2_GER_VTAS', (((('select Min(Fechca) from ' || $PHNINVCA) || ' Where fechca != ') || $fecha_ini) || ''));$Fecha_maxima_HN = sql('DS_DB2_GER_VTAS', (((('select Max(Fechca) from ' || $PHNINVCA) || ' Where fechca != ') || $fecha_ini) || ''));print(((('HN: Fecha Minima: ' || $Fecha_minima_HN) || ' Fecha Maxima: ') || $Fecha_maxima_HN));sql('DS_SQL_SERVER_STAGE_BI_DEV', (((('DELETE FROM STAGE_BI.DWH.CA WHERE id_pais = 2 and FECHCA between ' || $Fecha_minima_HN) || ' and ') || $Fecha_maxima_HN) || ';'));$NEWINVCA = ($tbl_NEWINV || $periodo);print(($tbl_NEWINV || $periodo));print($NEWINVCA);$Fecha_minima_SV = '';$Fecha_maxima_SV = '';$Fecha_minima_SV = sql('DS_DB2_GER_VTAS', (((('select Min(Fechca) from ' || $NEWINVCA) || ' Where fechca != \'') || $fecha_ini) || '\''));$Fecha_maxima_SV = sql('DS_DB2_GER_VTAS', (((('select Max(Fechca) from ' || $NEWINVCA) || ' Where fechca != \'') || $fecha_ini) || '\''));print(((('SV: Fecha Minima: ' || $Fecha_minima_SV) || ' Fecha Maxima: ') || $Fecha_maxima_SV));sql('DS_SQL_SERVER_STAGE_BI_DEV', (((('DELETE FROM STAGE_BI.DWH.CA WHERE id_pais = 1 and FECHCA between ' || $Fecha_minima_SV) || ' and ') || $Fecha_maxima_SV) || ';'));END
 AlGUIComment ("UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>332</CX><CY>-179</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-190</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "x" = '1392', "y" = '0')
CALL DATAFLOW DF_CRG_STG_CA::'785e3100-169f-4085-9394-df7a4b653289'();
END
 SET ("run_once" = 'no', "unit_of_recovery" = 'no', "workflow_type" = 'Regular')
