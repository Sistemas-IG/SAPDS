#__AW_Repository_Version '14.2.14.0000';
#__AW_Product_Version '14.2.14.2660';
#__AW_ATL_Locale 'spa_sv.utf-8';
 AlGUIComment ("ActaName_1" = 'RSavedAfterCheckOut', "ActaName_2" = 'RDate_created', "ActaValue_1" = 'YES', "ActaValue_2" = 'Mon Sep 19 16:59:45 2022', "x" = '-1', "y" = '-1')
CREATE DATABASE DATASTORE DS_DB2_GER_VTAS::'0705c125-c4a3-4f1f-9856-d2aa0a018dd5' SET ("DBLiveLoad" = 'no', "application_type" = 'Custom', "cdc_enabled" = 'no', "cdc_type" = 'native', "datastore_repotype" = 'local', "ds_configuration_enabled" = 'yes', "ds_configurations" = '<?xml version="1.0" encoding="WINDOWS-1252" ?>
<DSConfigurations>
<DSConfiguration default="true" name="Configuration1">
<case_sensitive>yes</case_sensitive>
<database_type>ODBC</database_type>
<db_date_format>yyyy-mm-dd</db_date_format>
<db_datetime_format>yyyy-mm-dd hh:mi:ss</db_datetime_format>
<db_decimal_separator>.</db_decimal_separator>
<db_driver_supports_array_fetch>no</db_driver_supports_array_fetch>
<db_driver_supports_param_sql>odbc_automatic</db_driver_supports_param_sql>
<db_time_format>hh:mi:ss</db_time_format>
<loader_xact_size>1000</loader_xact_size>
<locale_codepage>&lt;default&gt;</locale_codepage>
<locale_language>&lt;default&gt;</locale_language>
<locale_territory>&lt;default&gt;</locale_territory>
<odbc_autocommit_support>odbc_automatic</odbc_autocommit_support>
<odbc_convert_func_support>odbc_automatic</odbc_convert_func_support>
<odbc_data_source>Power IBM</odbc_data_source>
<odbc_database_type>OTHER</odbc_database_type>
<odbc_func_absolute>odbc_automatic</odbc_func_absolute>
<odbc_func_avg>odbc_automatic</odbc_func_avg>
<odbc_func_ceiling>odbc_automatic</odbc_func_ceiling>
<odbc_func_count>odbc_automatic</odbc_func_count>
<odbc_func_count_distinct>odbc_automatic</odbc_func_count_distinct>
<odbc_func_dayofmonth>odbc_automatic</odbc_func_dayofmonth>
<odbc_func_dayofyear>odbc_automatic</odbc_func_dayofyear>
<odbc_func_floor>odbc_automatic</odbc_func_floor>
<odbc_func_lcase>odbc_automatic</odbc_func_lcase>
<odbc_func_length>odbc_automatic</odbc_func_length>
<odbc_func_ln>odbc_automatic</odbc_func_ln>
<odbc_func_log>odbc_automatic</odbc_func_log>
<odbc_func_ltrim_blanks>odbc_automatic</odbc_func_ltrim_blanks>
<odbc_func_max>odbc_automatic</odbc_func_max>
<odbc_func_min>odbc_automatic</odbc_func_min>
<odbc_func_mod>odbc_automatic</odbc_func_mod>
<odbc_func_month>odbc_automatic</odbc_func_month>
<odbc_func_power>odbc_automatic</odbc_func_power>
<odbc_func_quarter>odbc_automatic</odbc_func_quarter>
<odbc_func_round>odbc_automatic</odbc_func_round>
<odbc_func_rtrim_blanks>odbc_automatic</odbc_func_rtrim_blanks>
<odbc_func_soundex>odbc_automatic</odbc_func_soundex>
<odbc_func_sqrt>odbc_automatic</odbc_func_sqrt>
<odbc_func_substring>odbc_automatic</odbc_func_substring>
<odbc_func_sum>odbc_automatic</odbc_func_sum>
<odbc_func_sysdate>odbc_automatic</odbc_func_sysdate>
<odbc_func_systime>odbc_automatic</odbc_func_systime>
<odbc_func_truncate>odbc_automatic</odbc_func_truncate>
<odbc_func_ucase>odbc_automatic</odbc_func_ucase>
<odbc_func_week>odbc_automatic</odbc_func_week>
<odbc_func_year>odbc_automatic</odbc_func_year>
<odbc_ifthenelse_func_support>no</odbc_ifthenelse_func_support>
<odbc_ms_access>no</odbc_ms_access>
<odbc_nvarchar_type_name>&lt;unknown&gt;</odbc_nvarchar_type_name>
<odbc_nvl_func_support>odbc_automatic</odbc_nvl_func_support>
<odbc_outer_join_support>odbc_automatic</odbc_outer_join_support>
<odbc_sql92_join_support>odbc_automatic</odbc_sql92_join_support>
<password>+0400000000120303000803E83C960D90D78B4BE8D013A3C25BB2B4835AE5F038CAC447E009A1052E4C32CACD9D448938E239DCF972EC7588B87DF6</password>
<server_codepage>&lt;default&gt;</server_codepage>
<server_sorts_in_binary>yes</server_sorts_in_binary>
<user>SIF2016</user>
</DSConfiguration>
</DSConfigurations>
', "enable_data_transfer" = 'yes', "import_unknown_type" = 'yes', "name" = 'DS_DB2_GER_VTAS', "pcache_force_utf16" = 'no', "unknown_type_size" = '255');
 AlGUIComment ("ActaName_1" = 'RSavedAfterCheckOut', "ActaName_2" = 'RDate_created', "ActaValue_1" = 'YES', "ActaValue_2" = 'Mon Sep 19 16:59:45 2022', "x" = '-1', "y" = '-1')
CREATE DATABASE DATASTORE DS_SQL_SERVER_STAGE_BI::'08acadc3-6105-46be-9799-5f2e06ed4d18' SET ("DBLiveLoad" = 'no', "application_type" = 'Custom', "cdc_enabled" = 'no', "cdc_type" = 'native', "datastore_repotype" = 'local', "ds_configuration_enabled" = 'yes', "ds_configurations" = '<?xml version="1.0" encoding="WINDOWS-1252" ?>
<DSConfigurations>
<DSConfiguration default="true" name="Configuration1">
<case_sensitive>no</case_sensitive>
<cdc_ra_password>+0400000000120303000803E808BC87560238ED6966F291537C1593CE237C3AE9BA7C64D414698DFBACD27D66148F45BC0EC7DF0655F0D153BB</cdc_ra_password>
<cdc_ra_server>DS_RA</cdc_ra_server>
<cdc_ra_user>sa</cdc_ra_user>
<cdc_rs_password>+0400000000120303000803E844AE241C2F3D921CA22874E85EC65B2B9849B1237B34BD69763D31B8DB1CA8F1DDA8C9F1D33BB05B9FF3C0A07D</cdc_rs_password>
<cdc_rs_retention>0</cdc_rs_retention>
<cdc_rs_server>SAMPLE_RS</cdc_rs_server>
<cdc_rs_user>ds</cdc_rs_user>
<database_subtype>On Premise</database_subtype>
<database_type>Microsoft_SQL_Server</database_type>
<loader_xact_size>1000</loader_xact_size>
<locale_codepage>&lt;default&gt;</locale_codepage>
<locale_language>&lt;default&gt;</locale_language>
<locale_territory>&lt;default&gt;</locale_territory>
<mssql_windows_authentication>no</mssql_windows_authentication>
<password>+0400000000120303000803E889B529946135C91732AA9A5F9C6705A86575F2F4F46F61FFCA1A9D4124810634B0ACF06BD0667A4D964B4D405BD4A136D2F54BFE2B27</password>
<server_codepage>&lt;default&gt;</server_codepage>
<sql_server_database>STAGE_BI</sql_server_database>
<sql_server_dataserver>DATAWAREHOUSE</sql_server_dataserver>
<sql_server_version>Microsoft SQL Server 2019</sql_server_version>
<use_ssl_encryption>no</use_ssl_encryption>
<user>sa</user>
</DSConfiguration>
</DSConfigurations>
', "enable_data_transfer" = 'yes', "import_unknown_type" = 'no', "name" = 'DS_SQL_SERVER_STAGE_BI', "pcache_force_utf16" = 'no', "unknown_type_size" = '255');

 AlGUIComment (ActaName_1 = 'RTotal_Number_Of_Rows_Processed',ActaValue_1 = '271906' , 
ActaName_2 = 'RNumber_Of_Rows_Rejected',ActaValue_2 = '0' , 
ActaName_3 = 'RNumber_Of_Inserts',ActaValue_3 = '271906' , 
ActaName_4 = 'RElapsed_Time_For_Load',ActaValue_4 = '12 Seconds' , 
ActaName_5 = 'RDatabase_Object_Type',ActaValue_5 = 'TABLE' , 
ActaName_6 = 'RTable_Type',ActaValue_6 = 'TABLE' , 
ActaName_7 = 'RDescription',ActaValue_7 = '' , 
ActaName_8 = 'REstimated_Row_Count',ActaValue_8 = '50000' , 
ActaName_9 = 'RLoader_Is_Template_Table',ActaValue_9 = 'no' , 
ActaName_10 = 'RSavedAfterCheckOut',ActaValue_10 = 'YES' , 
ActaName_11 = 'RDate_created',ActaValue_11 = 'Wed Sep 28 11:42:20 2022' , 
ActaName_12 = 'RDate_last_loaded',ActaValue_12 = 'Wed Feb  7 09:55:54 2024' , 
ActaName_13 = 'RDate_modified',ActaValue_13 = 'Wed Sep 28 12:06:11 2022' )
CREATE TABLE DS_SQL_SERVER_STAGE_BI.DWH.SPMOVH01(ID_PAIS INT  NULL  SET("ui_mapping_text" = 'Merge.ID_PAIS'), 
ANO4MS VARCHAR(4)  NULL  SET("Description" = 'ANO MOV', "ui_mapping_text" = 'Merge.ANO4MS'), 
MES2MS VARCHAR(2)  NULL  SET("Description" = 'MES MOV', "ui_mapping_text" = 'Merge.MES2MS'), 
SUCUMS VARCHAR(2)  NULL  SET("Description" = 'SUCURSAL', "ui_mapping_text" = 'Merge.SUCUMS'), 
CLIEMS VARCHAR(4)  NULL  SET("Description" = 'CODIGO DE CLIENTE', "ui_mapping_text" = 'Merge.CLIEMS'), 
FECHMS DECIMAL(8, 0)  NULL  SET("Description" = 'FECHA TRANSACCION', "ui_mapping_text" = 'Merge.FECHMS'), 
HORAMS DECIMAL(6, 0)  NULL  SET("Description" = 'HORA  TRANSACCION', "ui_mapping_text" = 'Merge.HORAMS'), 
USERMS VARCHAR(10)  NULL  SET("Description" = 'USER  TRANSACCION', "ui_mapping_text" = 'Merge.USERMS'), 
TIPTMS VARCHAR(2)  NULL  SET("Description" = 'TIPO TRANSACCION', "ui_mapping_text" = 'Merge.TIPTMS'), 
NUMTMS DECIMAL(6, 0)  NULL  SET("Description" = 'NUMERO TRANSACCION', "ui_mapping_text" = 'Merge.NUMTMS'), 
SPTOMS DECIMAL(7, 2)  NULL  SET("Description" = 'SUPER-PUNTOS', "ui_mapping_text" = 'Merge.SPTOMS'), 
TIPMMS VARCHAR(1)  NULL  SET("Description" = 'TIPO DOCUMENTO F/R', "ui_mapping_text" = 'Merge.TIPMMS'), 
CODPMS VARCHAR(10)  NULL  SET("Description" = 'CODIGO ARTICULO', "ui_mapping_text" = 'Merge.CODPMS'), 
CANTMS DECIMAL(5, 0)  NULL  SET("Description" = 'CANTIDAD ARTICULO', "ui_mapping_text" = 'Merge.CANTMS'), 
CADEMS DECIMAL(6, 0)  NULL  SET("Description" = 'NUMERO CANJE DEV.', "ui_mapping_text" = 'Merge.CADEMS'), 
FECHA_TRANSACCION DATETIME(9)  NULL  SET("Native Type" = 'DATETIME2', "ui_mapping_text" = 'Fecha_Datetime_Stage( Merge.FEC_TRANS,Merge.HOR_TRANS )'), 
FECHA_CARGA_DWH DATETIME(9)  NULL  SET("Native Type" = 'DATETIME2', "ui_mapping_text" = 'sysdate( )')) 
SET("db_alias_name" = 'DWH')
;
 AlGUIComment ("ActaName_1" = 'RSavedAfterCheckOut', "ActaName_2" = 'RDate_created', "ActaName_3" = 'RDate_modified', "ActaValue_1" = 'YES', "ActaValue_2" = 'Wed Sep  7 12:35:38 2022', "ActaValue_3" = 'Tue May  2 10:47:34 2023', "x" = '-1', "y" = '-1')
CREATE  DATAFLOW DF_CRG_STG_SPMOVH01::'884fd9f1-815c-48cb-976c-667c469abf49'
BEGIN

ALGUIComment ("InputSchema_WidthProp" = '35', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Name" = '278', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Mapping', "Output_3rd_Column_Name" = 'Description', "Output_Column_Name_4" = 'Content_Type', "Output_Column_Name_5" = 'Business_Name', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '298', "Output_Width_Name" = '359', "Output_Width_Type" = '109', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>238</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UI_PASSTHRU_VSPLIT_PCT" = '50', "UpperContainer_HeightProp" = '44', "ui_acta_from_schema_0" = 'SQL_SPMOVH01_SV', "ui_display_name" = 'QRY_SV', "x" = '1017', "y" = '-573')
GUID::'7bdcef8a-621c-44b1-b17c-987f8f5f157e' CREATE VIEW QRY_SV( ID_PAIS INT  SET( "ui_mapping_text" = '1') ,
 ANO4MS VARCHAR(4)  SET( "Description" = 'ANO MOV', "ui_mapping_text" = 'SQL_SPMOVH01_SV.ANO4MS') ,
 MES2MS VARCHAR(2)  SET( "Description" = 'MES MOV', "ui_mapping_text" = 'SQL_SPMOVH01_SV.MES2MS') ,
 SUCUMS VARCHAR(2)  SET( "Description" = 'SUCURSAL', "ui_mapping_text" = 'SQL_SPMOVH01_SV.SUCUMS') ,
 CLIEMS VARCHAR(4)  SET( "Description" = 'CODIGO DE CLIENTE', "ui_mapping_text" = 'SQL_SPMOVH01_SV.CLIEMS') ,
 FECHMS DECIMAL(8, 0)  SET( "Description" = 'FECHA TRANSACCION', "ui_mapping_text" = 'SQL_SPMOVH01_SV.FECHMS') ,
 HORAMS DECIMAL(6, 0)  SET( "Description" = 'HORA  TRANSACCION', "ui_mapping_text" = 'SQL_SPMOVH01_SV.HORAMS') ,
 USERMS VARCHAR(10)  SET( "Description" = 'USER  TRANSACCION', "ui_mapping_text" = 'SQL_SPMOVH01_SV.USERMS') ,
 TIPTMS VARCHAR(2)  SET( "Description" = 'TIPO TRANSACCION', "ui_mapping_text" = 'SQL_SPMOVH01_SV.TIPTMS') ,
 NUMTMS DECIMAL(6, 0)  SET( "Description" = 'NUMERO TRANSACCION', "ui_mapping_text" = 'SQL_SPMOVH01_SV.NUMTMS') ,
 SPTOMS DECIMAL(7, 2)  SET( "Description" = 'SUPER-PUNTOS', "ui_mapping_text" = 'SQL_SPMOVH01_SV.SPTOMS') ,
 TIPMMS VARCHAR(1)  SET( "Description" = 'TIPO DOCUMENTO F/R', "ui_mapping_text" = 'SQL_SPMOVH01_SV.TIPMMS') ,
 CODPMS VARCHAR(10)  SET( "Description" = 'CODIGO ARTICULO', "ui_mapping_text" = 'SQL_SPMOVH01_SV.CODPMS') ,
 CANTMS DECIMAL(5, 0)  SET( "Description" = 'CANTIDAD ARTICULO', "ui_mapping_text" = 'SQL_SPMOVH01_SV.CANTMS') ,
 CADEMS DECIMAL(6, 0)  SET( "Description" = 'NUMERO CANJE DEV.', "ui_mapping_text" = 'SQL_SPMOVH01_SV.CADEMS') ,
 FEC_TRANS VARCHAR(8)  SET( "ui_mapping_text" = 'Fecha_num_a_varchar( SQL_SPMOVH01_SV.FECHMS )') ,
 HOR_TRANS VARCHAR(8)  SET( "ui_mapping_text" = 'Hora_num_a_varchar( SQL_SPMOVH01_SV.HORAMS )')  )
 AS
SELECT 1, SQL_SPMOVH01_SV.ANO4MS, SQL_SPMOVH01_SV.MES2MS, SQL_SPMOVH01_SV.SUCUMS, SQL_SPMOVH01_SV.CLIEMS, SQL_SPMOVH01_SV.FECHMS, SQL_SPMOVH01_SV.HORAMS, SQL_SPMOVH01_SV.USERMS, SQL_SPMOVH01_SV.TIPTMS, SQL_SPMOVH01_SV.NUMTMS, SQL_SPMOVH01_SV.SPTOMS, SQL_SPMOVH01_SV.TIPMMS, SQL_SPMOVH01_SV.CODPMS, SQL_SPMOVH01_SV.CANTMS, SQL_SPMOVH01_SV.CADEMS, fecha_num_a_varchar(SQL_SPMOVH01_SV.FECHMS), hora_num_a_varchar(SQL_SPMOVH01_SV.HORAMS) FROM SQL_SPMOVH01_SV 
SET("distinct_run_as_separate_process" = 'no', "group_by_run_as_separate_process" = 'no', "join_run_as_separate_process" = 'no', "order_by_run_as_separate_process" = 'no', "run_as_separate_process" = 'no')
;

ALGUIComment ("InputSchema_WidthProp" = '35', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Mapping', "Output_3rd_Column_Name" = 'Description', "Output_Column_Name_4" = 'Content_Type', "Output_Column_Name_5" = 'Business_Name', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>238</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UI_PASSTHRU_VSPLIT_PCT" = '50', "UpperContainer_HeightProp" = '44', "ui_acta_from_schema_0" = 'SQL_SPMOVH01_HN', "ui_display_name" = 'QRY_HN', "x" = '1027', "y" = '-1387')
GUID::'ec8959a9-fb11-4134-8f10-bf311630efd1' CREATE VIEW QRY_HN( ID_PAIS INT  SET( "ui_mapping_text" = '2') ,
 ANO4MS VARCHAR(4)  SET( "Description" = 'ANO MOV', "ui_mapping_text" = 'SQL_SPMOVH01_HN.ANO4MS') ,
 MES2MS VARCHAR(2)  SET( "Description" = 'MES MOV', "ui_mapping_text" = 'SQL_SPMOVH01_HN.MES2MS') ,
 SUCUMS VARCHAR(2)  SET( "Description" = 'SUCURSAL', "ui_mapping_text" = 'SQL_SPMOVH01_HN.SUCUMS') ,
 CLIEMS VARCHAR(4)  SET( "Description" = 'CODIGO DE CLIENTE', "ui_mapping_text" = 'SQL_SPMOVH01_HN.CLIEMS') ,
 FECHMS DECIMAL(8, 0)  SET( "Description" = 'FECHA TRANSACCION', "ui_mapping_text" = 'SQL_SPMOVH01_HN.FECHMS') ,
 HORAMS DECIMAL(6, 0)  SET( "Description" = 'HORA  TRANSACCION', "ui_mapping_text" = 'SQL_SPMOVH01_HN.HORAMS') ,
 USERMS VARCHAR(10)  SET( "Description" = 'USER  TRANSACCION', "ui_mapping_text" = 'SQL_SPMOVH01_HN.USERMS') ,
 TIPTMS VARCHAR(2)  SET( "Description" = 'TIPO TRANSACCION', "ui_mapping_text" = 'SQL_SPMOVH01_HN.TIPTMS') ,
 NUMTMS DECIMAL(6, 0)  SET( "Description" = 'NUMERO TRANSACCION', "ui_mapping_text" = 'SQL_SPMOVH01_HN.NUMTMS') ,
 SPTOMS DECIMAL(7, 2)  SET( "Description" = 'SUPER-PUNTOS', "ui_mapping_text" = 'SQL_SPMOVH01_HN.SPTOMS') ,
 TIPMMS VARCHAR(1)  SET( "Description" = 'TIPO DOCUMENTO F/R', "ui_mapping_text" = 'SQL_SPMOVH01_HN.TIPMMS') ,
 CODPMS VARCHAR(10)  SET( "Description" = 'CODIGO ARTICULO', "ui_mapping_text" = 'SQL_SPMOVH01_HN.CODPMS') ,
 CANTMS DECIMAL(5, 0)  SET( "Description" = 'CANTIDAD ARTICULO', "ui_mapping_text" = 'SQL_SPMOVH01_HN.CANTMS') ,
 CADEMS DECIMAL(6, 0)  SET( "Description" = 'NUMERO CANJE DEV.', "ui_mapping_text" = 'SQL_SPMOVH01_HN.CADEMS') ,
 FEC_TRANS VARCHAR(8)  SET( "ui_mapping_text" = 'Fecha_num_a_varchar( SQL_SPMOVH01_HN.FECHMS )') ,
 HOR_TRANS VARCHAR(8)  SET( "ui_mapping_text" = 'Hora_num_a_varchar( SQL_SPMOVH01_HN.HORAMS )')  )
 AS
SELECT 2, SQL_SPMOVH01_HN.ANO4MS, SQL_SPMOVH01_HN.MES2MS, SQL_SPMOVH01_HN.SUCUMS, SQL_SPMOVH01_HN.CLIEMS, SQL_SPMOVH01_HN.FECHMS, SQL_SPMOVH01_HN.HORAMS, SQL_SPMOVH01_HN.USERMS, SQL_SPMOVH01_HN.TIPTMS, SQL_SPMOVH01_HN.NUMTMS, SQL_SPMOVH01_HN.SPTOMS, SQL_SPMOVH01_HN.TIPMMS, SQL_SPMOVH01_HN.CODPMS, SQL_SPMOVH01_HN.CANTMS, SQL_SPMOVH01_HN.CADEMS, fecha_num_a_varchar(SQL_SPMOVH01_HN.FECHMS), hora_num_a_varchar(SQL_SPMOVH01_HN.HORAMS) FROM SQL_SPMOVH01_HN 
SET("distinct_run_as_separate_process" = 'no', "group_by_run_as_separate_process" = 'no', "join_run_as_separate_process" = 'no', "order_by_run_as_separate_process" = 'no', "run_as_separate_process" = 'no')
;

ALGUIComment ("InputSchema_WidthProp" = '35', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Mapping', "Output_3rd_Column_Name" = 'Description', "Output_Column_Name_4" = 'Content_Type', "Output_Column_Name_5" = 'Business_Name', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '834', "Output_Width_Name" = '301', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>403</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UI_PASSTHRU_VSPLIT_PCT" = '50', "UpperContainer_HeightProp" = '44', "ui_acta_from_schema_0" = 'Merge', "ui_display_name" = 'QRY_STG_SPMOVH01', "x" = '2159', "y" = '-978')
GUID::'f9d66673-00a4-4093-87da-52b648cc78ef' CREATE VIEW QRY_STG_SPMOVH01( ID_PAIS INT  SET( "ui_mapping_text" = 'Merge.ID_PAIS') ,
 ANO4MS VARCHAR(4)  SET( "Description" = 'ANO MOV', "ui_mapping_text" = 'Merge.ANO4MS') ,
 MES2MS VARCHAR(2)  SET( "Description" = 'MES MOV', "ui_mapping_text" = 'Merge.MES2MS') ,
 SUCUMS VARCHAR(2)  SET( "Description" = 'SUCURSAL', "ui_mapping_text" = 'Merge.SUCUMS') ,
 CLIEMS VARCHAR(4)  SET( "Description" = 'CODIGO DE CLIENTE', "ui_mapping_text" = 'Merge.CLIEMS') ,
 FECHMS DECIMAL(8, 0)  SET( "Description" = 'FECHA TRANSACCION', "ui_mapping_text" = 'Merge.FECHMS') ,
 HORAMS DECIMAL(6, 0)  SET( "Description" = 'HORA  TRANSACCION', "ui_mapping_text" = 'Merge.HORAMS') ,
 USERMS VARCHAR(10)  SET( "Description" = 'USER  TRANSACCION', "ui_mapping_text" = 'Merge.USERMS') ,
 TIPTMS VARCHAR(2)  SET( "Description" = 'TIPO TRANSACCION', "ui_mapping_text" = 'Merge.TIPTMS') ,
 NUMTMS DECIMAL(6, 0)  SET( "Description" = 'NUMERO TRANSACCION', "ui_mapping_text" = 'Merge.NUMTMS') ,
 SPTOMS DECIMAL(7, 2)  SET( "Description" = 'SUPER-PUNTOS', "ui_mapping_text" = 'Merge.SPTOMS') ,
 TIPMMS VARCHAR(1)  SET( "Description" = 'TIPO DOCUMENTO F/R', "ui_mapping_text" = 'Merge.TIPMMS') ,
 CODPMS VARCHAR(10)  SET( "Description" = 'CODIGO ARTICULO', "ui_mapping_text" = 'Merge.CODPMS') ,
 CANTMS DECIMAL(5, 0)  SET( "Description" = 'CANTIDAD ARTICULO', "ui_mapping_text" = 'Merge.CANTMS') ,
 CADEMS DECIMAL(6, 0)  SET( "Description" = 'NUMERO CANJE DEV.', "ui_mapping_text" = 'Merge.CADEMS') ,
 FECHA_TRANSACCION DATETIME(9)  SET( "ui_mapping_text" = 'decode( Fecha_Datetime_Stage(Merge.FEC_TRANS,Merge.HOR_TRANS) IS NULL, sysdate( ), Fecha_Datetime_Stage(Merge.FEC_TRANS,Merge.HOR_TRANS))') ,
 FECHA_CARGA_DWH DATETIME(9)  SET( "ui_mapping_text" = 'sysdate( )')  )
 AS
SELECT Merge.ID_PAIS, Merge.ANO4MS, Merge.MES2MS, Merge.SUCUMS, Merge.CLIEMS, Merge.FECHMS, Merge.HORAMS, Merge.USERMS, Merge.TIPTMS, Merge.NUMTMS, Merge.SPTOMS, Merge.TIPMMS, Merge.CODPMS, Merge.CANTMS, Merge.CADEMS, decode((fecha_datetime_stage(Merge.FEC_TRANS, Merge.HOR_TRANS) IS  NULL ), sysdate(), fecha_datetime_stage(Merge.FEC_TRANS, Merge.HOR_TRANS)), sysdate() FROM Merge 
SET("distinct_run_as_separate_process" = 'no', "group_by_run_as_separate_process" = 'no', "join_run_as_separate_process" = 'no', "order_by_run_as_separate_process" = 'no', "run_as_separate_process" = 'no')
;

ALGUIComment ("InputSchema_WidthProp" = '35', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Description', "Output_3rd_Column_Name" = 'Content_Type', "Output_Column_Name_4" = 'Business_Name', "Output_Column_Name_5" = 'Description', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Name" = '359', "Output_Width_Type" = '109', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>238</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UpperContainer_HeightProp" = '44', "x" = '1631', "y" = '-977')
GUID::'b78455e0-e7a0-43db-85f6-de6f7b275872' CALL TRANSFORM Merge() INPUT(QRY_HN, QRY_SV) OUTPUT(Merge()
);

ALGUIComment ("InputSchema_WidthProp" = '35', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Description', "Output_3rd_Column_Name" = 'Content_Type', "Output_Column_Name_4" = 'Business_Name', "Output_Column_Name_5" = 'Description', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>334</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UpperContainer_HeightProp" = '44', "ui_display_name" = 'SQL_SPMOVH01_SV', "x" = '418', "y" = '-571')
GUID::'9656d321-1322-4dfb-9712-d8fd7a5684fa' CALL TRANSFORM SQL() OUTPUT(SQL_SPMOVH01_SV( ANO4MS VARCHAR(4) ,
 MES2MS VARCHAR(2) ,
 SUCUMS VARCHAR(2) ,
 CLIEMS VARCHAR(4) ,
 FECHMS DECIMAL(8, 0) ,
 HORAMS DECIMAL(6, 0) ,
 USERMS VARCHAR(10) ,
 TIPTMS VARCHAR(2) ,
 NUMTMS DECIMAL(6, 0) ,
 SPTOMS DECIMAL(7, 2) ,
 TIPMMS VARCHAR(1) ,
 CODPMS VARCHAR(10) ,
 CANTMS DECIMAL(5, 0) ,
 CADEMS DECIMAL(6, 0)  )
)
SET("array_fetch_size" = '1000', "cache" = 'no', "database_datastore" = 'DS_DB2_GER_VTAS', "sql_transform_configuration_enabled" = 'yes', "sql_transform_configurations" = '<?xml version="1.0" encoding="UTF-8"?>
<SQLTexts>
<SQLText database_type="ODBC" database_version="ODBC">
<odbc_database_type>OTHER</odbc_database_type>
<sql_text>SELECT * &#xD;&#xA;FROM NEWINV.SPMOVH01 &#xD;&#xA;Where fechms &gt;= to_char(add_months(current_date,- [$Meses] ),\'yyyymm\')||\'01\'</sql_text>
</SQLText>
</SQLTexts>', "table_weight" = '0');

ALGUIComment ("InputSchema_WidthProp" = '35', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Description', "Output_3rd_Column_Name" = 'Content_Type', "Output_Column_Name_4" = 'Business_Name', "Output_Column_Name_5" = 'Description', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>331</CX><CY>-164</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UpperContainer_HeightProp" = '44', "ui_display_name" = 'SQL_SPMOVH01_HN', "x" = '431', "y" = '-1388')
GUID::'a0bf11fe-a826-46b1-8429-8a9bc9e6a8ee' CALL TRANSFORM SQL() OUTPUT(SQL_SPMOVH01_HN( ANO4MS VARCHAR(4) ,
 MES2MS VARCHAR(2) ,
 SUCUMS VARCHAR(2) ,
 CLIEMS VARCHAR(4) ,
 FECHMS DECIMAL(8, 0) ,
 HORAMS DECIMAL(6, 0) ,
 USERMS VARCHAR(10) ,
 TIPTMS VARCHAR(2) ,
 NUMTMS DECIMAL(6, 0) ,
 SPTOMS DECIMAL(7, 2) ,
 TIPMMS VARCHAR(1) ,
 CODPMS VARCHAR(10) ,
 CANTMS DECIMAL(5, 0) ,
 CADEMS DECIMAL(6, 0)  )
)
SET("array_fetch_size" = '1000', "cache" = 'no', "database_datastore" = 'DS_DB2_GER_VTAS', "sql_transform_configuration_enabled" = 'yes', "sql_transform_configurations" = '<?xml version="1.0" encoding="UTF-8"?>
<SQLTexts>
<SQLText database_type="ODBC" database_version="ODBC">
<odbc_database_type>OTHER</odbc_database_type>
<sql_text>SELECT * &#xD;&#xA;FROM PHNINV.SPMOVH01 &#xD;&#xA;Where fechms &gt;= to_char(add_months(current_date,- [$Meses] ),\'yyyymm\')||\'01\'</sql_text>
</SQLText>
</SQLTexts>', "table_weight" = '0');

ALGUIComment ("InputSchema_WidthProp" = '35', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Description', "Output_3rd_Column_Name" = 'Content_Type', "Output_Column_Name_4" = 'Business_Name', "Output_Column_Name_5" = 'Description', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UI_DATA_XML" = '<UIDATA><MAINICON><LOCATION><X>0</X><Y>0</Y></LOCATION><SIZE><CX>438</CX><CY>-183</CY></SIZE></MAINICON><DESCRIPTION><LOCATION><X>0</X><Y>-175</Y></LOCATION><SIZE><CX>200</CX><CY>200</CY></SIZE><VISIBLE>0</VISIBLE></DESCRIPTION></UIDATA>', "UI_PASSTHRU_VSPLIT_PCT" = '50', "UpperContainer_HeightProp" = '44', "ui_display_name" = 'SPMOVH01(DS_SQL_SERVER_STAGE_BI.DWH)', "x" = '2758', "y" = '-979')
GUID::'f717e6eb-ad17-43f5-b118-f66d28e37d2c' LOAD TABLE DS_SQL_SERVER_STAGE_BI.DWH.SPMOVH01 INPUT(QRY_STG_SPMOVH01)
SET("LDRLiveLoad" = 'no', "Table_Type" = 'TABLE', "connection_port" = 'no', "ldr_configuration_enabled" = 'yes', "ldr_configurations" = '<?xml version="1.0" encoding="UTF-8"?>
<LDRConfigurations>
<LDRConfiguration database_type="Microsoft_SQL_Server" database_version="Microsoft SQL Server 2019">
<auto_correct_using_merge>yes</auto_correct_using_merge>
<bulk_col_delimiter>/127</bulk_col_delimiter>
<bulk_ldr_all_rows></bulk_ldr_all_rows>
<bulk_ldr_cleanup>yes</bulk_ldr_cleanup>
<bulk_ldr_max_errors></bulk_ldr_max_errors>
<bulk_ldr_rows_per_commit>3000</bulk_ldr_rows_per_commit>
<enable_partitioning>no</enable_partitioning>
<ignore_column_case>yes</ignore_column_case>
<ignore_columns_null>no</ignore_columns_null>
<ignore_columns_value></ignore_columns_value>
<loader_auto_correct>no</loader_auto_correct>
<loader_bulk_load>1</loader_bulk_load>
<loader_compare_column>compare_by_name</loader_compare_column>
<loader_delete_map></loader_delete_map>
<loader_drop_and_create_table>no</loader_drop_and_create_table>
<loader_fl_object_name></loader_fl_object_name>
<loader_insert_map></loader_insert_map>
<loader_load_choice>append</loader_load_choice>
<loader_num_parallel_loaders>1</loader_num_parallel_loaders>
<loader_overflow_file>DS_SQL_SERVER_STAGE_BI_DWH_SPMOVH01.txt</loader_overflow_file>
<loader_post_load1></loader_post_load1>
<loader_pre_load1></loader_pre_load1>
<loader_quote_names>0</loader_quote_names>
<loader_transactional>no</loader_transactional>
<loader_transactional_order>0</loader_transactional_order>
<loader_update_key_columns>no</loader_update_key_columns>
<loader_update_map></loader_update_map>
<loader_use_user_defined_keys>no</loader_use_user_defined_keys>
<loader_xact_size>1000</loader_xact_size>
<mssql_bulk_ldr_mode>append</mssql_bulk_ldr_mode>
<mssql_bulk_ldr_packet_size>4</mssql_bulk_ldr_packet_size>
<mssql_ldr_identity_insert>off</mssql_ldr_identity_insert>
<overflow_file_format>write_data</overflow_file_format>
<overriding_substitution_parameter_for_tablename></overriding_substitution_parameter_for_tablename>
<sql_text></sql_text>
<text_delimiter></text_delimiter>
<use_overflow_file>no</use_overflow_file>
<use_unicode_varchar>no</use_unicode_varchar>
<sql_text></sql_text>
</LDRConfiguration>
</LDRConfigurations>', "loader_template_table" = 'no', "name" = 'DS_SQL_SERVER_STAGE_BI', "use_unicode_varchar" = 'no');

END
 SET ("Cache_type" = 'pageable_cache', "Parallelism_degree" = 'default', "allows_both_input_and_output" = 'yes', "dataflow_loader_bulk_load" = 'no', "dataflow_loader_commit_size" = 'default', "dataflow_loader_row_size_bytes" = '0', "dataflow_number_of_loaders" = '0', "run_once" = 'no', "use_dataflow_links" = 'no', "use_datastore_links" = 'yes', "validation_xform_exists" = 'no', "validation_xform_stats" = 'no')
 AlGUIComment ("ActaName_1" = 'RActa_user_func_category', "ActaName_2" = 'RDescription', "ActaName_3" = 'RParallelizable', "ActaName_4" = 'RisScriptValidationFunction', "ActaName_5" = 'RSavedAfterCheckOut', "ActaName_6" = 'RDate_created', "ActaName_7" = 'RDate_modified', "ActaValue_1" = 'User_Script_Function', "ActaValue_2" = 'Conversion de campos varchar de fecha y hora a datetime', "ActaValue_3" = 'no', "ActaValue_4" = 'no', "ActaValue_5" = 'YES', "ActaValue_6" = 'Fri Sep 23 11:48:03 2022', "ActaValue_7" = 'Fri Sep 23 15:16:28 2022', "InputSchema_WidthProp" = '35', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Mapping', "Output_3rd_Column_Name" = 'Description', "Output_Column_Name_4" = 'Content_Type', "Output_Column_Name_5" = 'Business_Name', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UpperContainer_HeightProp" = '65', "ui_script_text" = '$fechaVarchar = $PR_FechaVarchar;
$horaVarchar = $PR_HoraVarchar;


$fechaInicial = \'20000101\';
$fechaFinal = \'20991231\'; 
$FechaHora = NULL;

try
	begin
	    if($fechaVarchar >= $fechaInicial and $fechaVarchar <= $fechaFinal )
          begin
             $FechaHora = to_date($fechaVarchar || \' \' || $horaVarchar, \'yyyymmdd hh24:mi:ss\' );
          end

	end
catch ( all )
	begin
	   sysdate( ); 	
	end

end_try


Return $FechaHora;', "x" = '-1', "y" = '-1')
CREATE FUNCTION Fecha_Datetime_Stage($PR_FechaVarchar VARCHAR(8)  IN, $PR_HoraVarchar VARCHAR(8)  IN )
RETURNS  DATETIME(9) 
DECLARE
     $FechaHora DATETIME(9) ;
     $fechaVarchar VARCHAR(8) ;
     $horaVarchar VARCHAR(8) ;
     $fechaInicial VARCHAR(8) ;
     $fechaFinal VARCHAR(8) ;
BEGIN
$fechaVarchar = $PR_FechaVarchar;$horaVarchar = $PR_HoraVarchar;$fechaInicial = '20000101';$fechaFinal = '20991231';$FechaHora =  NULL ;TRY
BEGIN
IF ((($fechaVarchar >= $fechaInicial) AND
   ($fechaVarchar <= $fechaFinal)) )
BEGIN
$FechaHora = to_date((($fechaVarchar || ' ') || $horaVarchar), 'yyyymmdd hh24:mi:ss');END
END
CATCH (210101)
BEGIN
sysdate();END

END_TRY
RETURN $FechaHora;
END
 AlGUIComment ("ActaName_1" = 'RActa_user_func_category', "ActaName_2" = 'RDescription', "ActaName_3" = 'RParallelizable', "ActaName_4" = 'RisScriptValidationFunction', "ActaName_5" = 'RSavedAfterCheckOut', "ActaName_6" = 'RDate_created', "ActaName_7" = 'RDate_modified', "ActaValue_1" = 'User_Script_Function', "ActaValue_2" = 'Conversion de campos de fecha en formato de numero a varchar', "ActaValue_3" = 'no', "ActaValue_4" = 'no', "ActaValue_5" = 'YES', "ActaValue_6" = 'Mon Mar 15 08:35:55 2021', "ActaValue_7" = 'Wed Dec  7 17:51:55 2022', "InputSchema_WidthProp" = '35', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Mapping', "Output_3rd_Column_Name" = 'Description', "Output_Column_Name_4" = 'Content_Type', "Output_Column_Name_5" = 'Business_Name', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UpperContainer_HeightProp" = '44', "ui_script_text" = '$fechaNum = $PR_FechaNum;
$fechaVarchar = ifthenelse(($fechaNum <> 0 AND length($fechaNum) = 8), cast($fechaNum ,\'varchar(8)\'), \'19000101\');
Return $fechaVarchar;', "x" = '-1', "y" = '-1')
CREATE FUNCTION Fecha_num_a_varchar($PR_FechaNum DECIMAL(8, 0)  IN )
RETURNS  VARCHAR(8) 
DECLARE
     $fechaNum DECIMAL(8, 0) ;
     $fechaVarchar VARCHAR(8) ;
BEGIN
$fechaNum = $PR_FechaNum;$fechaVarchar = ifthenelse((($fechaNum != 0) AND
   (length($fechaNum) = 8)), cast($fechaNum, 'varchar(8)'), '19000101');RETURN $fechaVarchar;
END
 AlGUIComment ("ActaName_1" = 'RActa_user_func_category', "ActaName_2" = 'RDescription', "ActaName_3" = 'RParallelizable', "ActaName_4" = 'RisScriptValidationFunction', "ActaName_5" = 'RSavedAfterCheckOut', "ActaName_6" = 'RDate_created', "ActaName_7" = 'RDate_modified', "ActaValue_1" = 'User_Script_Function', "ActaValue_2" = 'Conversion de campos de hora a varchar', "ActaValue_3" = 'no', "ActaValue_4" = 'no', "ActaValue_5" = 'YES', "ActaValue_6" = 'Mon Mar 15 08:46:26 2021', "ActaValue_7" = 'Fri Dec  8 14:40:44 2023', "InputSchema_WidthProp" = '38', "Input_1st_Column_Name" = 'Type', "Input_2nd_Column_Name" = 'Description', "Input_Column_Name_3" = 'Content_Type', "Input_Column_Name_4" = 'Business_Name', "Input_Column_Width_3" = '100', "Input_Column_Width_4" = '100', "Input_Width_Description" = '130', "Input_Width_Type" = '85', "Output_1st_Column_Name" = 'Type', "Output_2nd_Column_Name" = 'Mapping', "Output_3rd_Column_Name" = 'Description', "Output_Column_Name_4" = 'Content_Type', "Output_Column_Name_5" = 'Business_Name', "Output_Column_Width_4" = '100', "Output_Column_Width_5" = '100', "Output_Width_Decsription" = '130', "Output_Width_Mapping" = '85', "Output_Width_Type" = '80', "UpperContainer_HeightProp" = '45', "ui_script_text" = '$horaNum = lpad(cast($PR_HoraNum, \'varchar(6)\'),6,\'0\');
$horaVarchar = ifthenelse(length( $horaNum ) = 6, 
substr($horaNum,1,2)||\':\'|| substr($horaNum,3,2)||\':\'|| substr($horaNum,5,2), 
\'00:00:00\');

$horaVarchar = 
ifthenelse(cast(substr( $horaVarchar,1,2),\'INT\') <= 23 and cast(substr( $horaVarchar,4,2),\'INT\') <= 59 and cast(substr( $horaVarchar,7,2),\'INT\') <= 59, $horaVarchar,\'00:00:00\'); 

Return $horaVarchar;



', "x" = '-1', "y" = '-1')
CREATE FUNCTION Hora_num_a_varchar($PR_HoraNum DECIMAL(8, 0)  IN )
RETURNS  VARCHAR(8) 
DECLARE
     $horaNum VARCHAR(6) ;
     $horaVarchar VARCHAR(8) ;
BEGIN
$horaNum = lpad(cast($PR_HoraNum, 'varchar(6)'), 6, '0');$horaVarchar = ifthenelse((length($horaNum) = 6), ((((substr($horaNum, 1, 2) || ':') || substr($horaNum, 3, 2)) || ':') || substr($horaNum, 5, 2)), '00:00:00');$horaVarchar = ifthenelse((((cast(substr($horaVarchar, 1, 2), 'INT') <= 23) AND
   (cast(substr($horaVarchar, 4, 2), 'INT') <= 59)) AND
   (cast(substr($horaVarchar, 7, 2), 'INT') <= 59)), $horaVarchar, '00:00:00');RETURN $horaVarchar;
END
